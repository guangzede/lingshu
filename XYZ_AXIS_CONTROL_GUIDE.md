# 第一枚硬币XYZ坐标轴控制工具 - 使用指南

## 功能说明

已为 `ShakeCoins.tsx` 组件添加了一个**第一枚硬币XYZ轴旋转控制工具**，用于在摇硬币之后微调第一枚硬币的旋转参数。

## 工作流程

### 1. **摇硬币** 
- 点击"摇一摇"按钮，三枚硬币会物理模拟抛掷、旋转、碰撞、反弹等过程
- 硬币最终会稳定停留在桌面上

### 2. **出现控制面板**
- 硬币停稳后，自动显示 **XYZ轴旋转控制工具**
- 控制面板包含三个数字输入框，分别对应：
  - **X轴 (rad)**: 上下翻转角度
  - **Y轴 (rad)**: 左右翻转角度  
  - **Z轴 (rad)**: 旋转角度（绕屏幕法线）

### 3. **实时调整**
- 在输入框中输入旋转参数值（单位：弧度）
- 输入时，Canvas画面会**实时显示**第一枚硬币的旋转变化
- 可以直接看到调整结果，方便精确控制

### 4. **完成调整**
- 点击"完成调整 & 继续"按钮
- 第一枚硬币的旋转参数会被最终应用
- 流程继续进行（触发 `onDone` 回调，进入下一个摇卦步骤）

## 参数说明

所有旋转参数使用**弧度制（radians）**，范围通常为 `0 ~ 2π`：
- `0` 表示不旋转
- `π/2` ≈ 1.5708（90度）
- `π` ≈ 3.1416（180度）
- `2π` ≈ 6.2832（360度）

### 常用参数值示例

#### X轴（上下翻转）
- `0`: 平坦（正面朝上）
- `π`: 翻转（反面朝上）
- `π/2`: 侧竖（垂直于桌面）

#### Y轴（左右翻转）
- `0`: 正面朝向屏幕
- `π`: 反面朝向屏幕
- `π/2` 或 `3π/2`: 侧边朝向

#### Z轴（旋转）
- `0 ~ 2π`: 绕中心旋转（0-360度）

## 代码实现细节

### 新增状态变量
```typescript
const [showAxisControl, setShowAxisControl] = React.useState(false)
const [firstCoinRotation, setFirstCoinRotation] = React.useState({ x: 0, y: 0, z: 0 })
```

### 核心逻辑
1. 硬币停稳后，设置 `showAxisControl = true` 显示控制面板
2. 每一帧渲染时，实时读取 `firstCoinRotation` 状态
3. 应用到 `coinStates.current[0]`（第一枚硬币）的 `angleX`、`angleY`、`angleZ`
4. 用户点击"完成调整"后，最终确认参数并触发回调

### 实时更新机制
```typescript
coinStates.current.forEach((c, idx) => {
  // 如果显示坐标轴控制，实时应用第一枚硬币的旋转参数
  if (showAxisControl && idx === 0) {
    c.angleX = firstCoinRotation.x
    c.angleY = firstCoinRotation.y
    c.angleZ = firstCoinRotation.z
  }
  // ...绘制硬币
})
```

## 使用场景

- **调试**: 快速验证不同旋转参数下的硬币显示效果
- **校准**: 确保硬币的正反面显示正确
- **平铺指令**: 在完成平铺布局前，微调首枚硬币的角度
- **交互体验**: 提供实时反馈，让用户精确控制结果

## 集成位置

文件: `src/pages/Liuyao/components/ShakeCoins.tsx`

关键修改：
1. 导入 `Input` 组件
2. 添加两个新的状态变量
3. 修改 `startShake` 的动画结束逻辑（显示控制面板而非直接回调）
4. 添加 `handleCompleteRotation` 回调函数
5. 在渲染函数中实时应用旋转参数
6. 返回JSX中插入控制面板UI

## 下一步

当你准备好参数值时，可以：
1. 输入精确的旋转值
2. 观察实时效果
3. 给我反馈最终的参数值
4. 继续完成平铺指令的其他步骤
